<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern HR System</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .sidebar-link.active {
            background-color: #4f46e5; /* Indigo-600 */
            color: #ffffff;
            font-weight: 600;
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 2rem;
            border-radius: 0.75rem; /* rounded-lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
            width: 90%;
            max-width: 600px;
            position: relative;
        }
        .close-button {
            color: #aaa;
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 1.75rem; /* text-2xl */
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover,
        .close-button:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden">

    <!-- Sidebar -->
    <aside class="w-64 bg-gray-800 text-white flex flex-col shadow-lg rounded-r-lg m-4">
        <div class="p-6 text-2xl font-bold text-indigo-400 border-b border-gray-700">
            HR System
        </div>
        <nav class="flex-1 p-4 space-y-2">
            <a href="#" id="nav-dashboard" class="sidebar-link flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 active">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001 1h3v-3m-3 3h3v-3m-3 0V9m9 12h3v-3m-3 3v-3m-3-8h.01M12 12h.01"></path></svg>
                Dashboard
            </a>
            <a href="#" id="nav-employees" class="sidebar-link flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h-2v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2H3m14 0h2a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v11a2 2 0 002 2h2m8-11V9m0 3h-2M9 11h.01M15 11h.01M12 14v.01M12 17v.01"></path></svg>
                Employee Management
            </a>
            <a href="#" id="nav-leave" class="sidebar-link flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h.01M17 11h.01M7 21h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                Leave Management
            </a>
            <a href="#" id="nav-payroll" class="sidebar-link flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V3m0 9v3m0 3.01V21M6 21h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                Payroll
            </a>
            <a href="#" id="nav-reports" class="sidebar-link flex items-center p-3 rounded-lg hover:bg-gray-700 transition-colors duration-200">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-5m3 5v-5m3 5v-5m-12 12h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                Reports
            </a>
        </nav>
        <div class="p-4 border-t border-gray-700 text-sm text-gray-400">
            Â© 2025 HR System. All rights reserved.
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 p-8 overflow-y-auto rounded-l-lg m-4 bg-white shadow-xl">

        <!-- Dashboard Section -->
        <section id="dashboard-section" class="content-section">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Dashboard</h1>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Card 1: Total Employees -->
                <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-300">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold">Total Employees</h2>
                        <svg class="w-8 h-8 opacity-75" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h-2v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2H3m14 0h2a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v11a2 2 0 002 2h2m8-11V9m0 3h-2M9 11h.01M15 11h.01M12 14v.01M12 17v.01"></path></svg>
                    </div>
                    <p id="dashboard-total-employees" class="text-4xl font-bold mt-4">0</p>
                </div>

                <!-- Card 2: Pending Leave Requests -->
                <div class="bg-gradient-to-r from-yellow-500 to-orange-600 text-white p-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-300">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold">Pending Leave</h2>
                        <svg class="w-8 h-8 opacity-75" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h.01M17 11h.01M7 21h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    </div>
                    <p id="dashboard-pending-leave" class="text-4xl font-bold mt-4">0</p>
                </div>

                <!-- Card 3: Upcoming Birthdays (Placeholder) -->
                <div class="bg-gradient-to-r from-green-500 to-teal-600 text-white p-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-300">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold">Upcoming Birthdays</h2>
                        <svg class="w-8 h-8 opacity-75" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h.01M17 11h.01M7 21h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    </div>
                    <p class="text-4xl font-bold mt-4">3</p>
                </div>
            </div>

            <div class="mt-8 bg-gray-50 p-6 rounded-xl shadow-md">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Quick Actions</h3>
                <div class="flex flex-wrap gap-4">
                    <button class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 flex items-center" onclick="showSection('employees-section'); openEmployeeModal()">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                        Add New Employee
                    </button>
                    <button class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 flex items-center" onclick="showSection('leave-section'); openLeaveModal()">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                        Request Leave
                    </button>
                    <button class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                        Generate Report
                    </button>
                </div>
            </div>
        </section>

        <!-- Employee Management Section -->
        <section id="employees-section" class="content-section hidden">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Employee Management</h1>
            <button class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md mb-6 transition-all duration-300 transform hover:scale-105" onclick="openEmployeeModal()">Add New Employee</button>

            <div class="bg-white p-6 rounded-xl shadow-md overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tl-lg">ID</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Department</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tr-lg">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="employees-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- Employee rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Leave Management Section -->
        <section id="leave-section" class="content-section hidden">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Leave Management</h1>
            <button class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md mb-6 transition-all duration-300 transform hover:scale-105" onclick="openLeaveModal()">Request Leave</button>

            <div class="bg-white p-6 rounded-xl shadow-md overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tl-lg">ID</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee Name</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Start Date</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">End Date</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tr-lg">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="leave-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- Leave rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Payroll Section (Placeholder) -->
        <section id="payroll-section" class="content-section hidden">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Payroll Management</h1>
            <div class="bg-gray-100 p-6 rounded-xl shadow-md text-gray-700">
                <p>This section will contain payroll functionalities like generating payslips, managing salaries, etc. (To be implemented later).</p>
            </div>
        </section>

        <!-- Reports Section (Placeholder) -->
        <section id="reports-section" class="content-section hidden">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Reports & Analytics</h1>
            <div class="bg-gray-100 p-6 rounded-xl shadow-md text-gray-700">
                <p>This section will provide various HR reports and analytics. (To be implemented later).</p>
            </div>
        </section>

    </main>

    <!-- Employee Modal -->
    <div id="employee-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" onclick="closeEmployeeModal()">&times;</span>
            <h2 id="employee-modal-title" class="text-2xl font-bold text-gray-800 mb-6">Add New Employee</h2>
            <form id="employee-form" class="space-y-4">
                <input type="hidden" id="employee-id">
                <div>
                    <label for="employee-name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                    <input type="text" id="employee-name" name="name" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
                <div>
                    <label for="employee-email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="employee-email" name="email" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
                <div>
                    <label for="employee-department" class="block text-sm font-medium text-gray-700 mb-1">Department</label>
                    <input type="text" id="employee-department" name="department" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="closeEmployeeModal()" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-200">Save Employee</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Leave Modal -->
    <div id="leave-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" onclick="closeLeaveModal()">&times;</span>
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Request Leave</h2>
            <form id="leave-form" class="space-y-4">
                <div>
                    <label for="leave-employee-id" class="block text-sm font-medium text-gray-700 mb-1">Employee Name</label>
                    <select id="leave-employee-id" name="employeeId" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        <!-- Options populated by JS -->
                    </select>
                </div>
                <div>
                    <label for="leave-type" class="block text-sm font-medium text-gray-700 mb-1">Leave Type</label>
                    <select id="leave-type" name="type" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        <option value="">Select Type</option>
                        <option value="Annual">Annual Leave</option>
                        <option value="Sick">Sick Leave</option>
                        <option value="Maternity">Maternity Leave</option>
                        <option value="Paternity">Paternity Leave</option>
                        <option value="Unpaid">Unpaid Leave</option>
                    </select>
                </div>
                <div>
                    <label for="leave-start-date" class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
                    <input type="date" id="leave-start-date" name="startDate" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
                <div>
                    <label for="leave-end-date" class="block text-sm font-medium text-gray-700 mb-1">End Date</label>
                    <input type="date" id="leave-end-date" name="endDate" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="closeLeaveModal()" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-200">Submit Request</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Custom Message Box -->
    <div id="message-box" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center">
            <p id="message-box-text" class="text-lg font-semibold text-gray-800 mb-4"></p>
            <button onclick="closeMessageBox()" class="px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-200">OK</button>
        </div>
    </div>


    <script>
        // In-memory data storage (will be replaced by backend later)
        let employees = [];
        let leaves = [];
        let nextEmployeeId = 1;
        let nextLeaveId = 1;

        // --- Utility Functions for Message Box ---
        function showMessageBox(message) {
            const msgBox = document.getElementById('message-box');
            const msgBoxText = document.getElementById('message-box-text');
            msgBoxText.textContent = message;
            msgBox.classList.remove('hidden');
        }

        function closeMessageBox() {
            document.getElementById('message-box').classList.add('hidden');
        }

        // --- Section Navigation ---
        function showSection(sectionId) {
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });
            // Show the requested section
            document.getElementById(sectionId).classList.remove('hidden');

            // Update active link in sidebar
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });
            document.getElementById(`nav-${sectionId.replace('-section', '')}`).classList.add('active');

            // Update dashboard counts if we are navigating to dashboard
            if (sectionId === 'dashboard-section') {
                updateDashboardCounts();
            }
        }

        // Add event listeners for sidebar navigation
        document.getElementById('nav-dashboard').addEventListener('click', (e) => {
            e.preventDefault();
            showSection('dashboard-section');
        });
        document.getElementById('nav-employees').addEventListener('click', (e) => {
            e.preventDefault();
            showSection('employees-section');
            renderEmployees(); // Re-render employees when navigating to this section
        });
        document.getElementById('nav-leave').addEventListener('click', (e) => {
            e.preventDefault();
            showSection('leave-section');
            renderLeaves(); // Re-render leaves when navigating to this section
        });
        document.getElementById('nav-payroll').addEventListener('click', (e) => {
            e.preventDefault();
            showSection('payroll-section');
        });
        document.getElementById('nav-reports').addEventListener('click', (e) => {
            e.preventDefault();
            showSection('reports-section');
        });

        // --- Dashboard Updates ---
        function updateDashboardCounts() {
            document.getElementById('dashboard-total-employees').textContent = employees.length;
            const pendingLeaves = leaves.filter(leave => leave.status === 'Pending').length;
            document.getElementById('dashboard-pending-leave').textContent = pendingLeaves;
        }

        // --- Employee Management Functions ---
        const employeeModal = document.getElementById('employee-modal');
        const employeeForm = document.getElementById('employee-form');
        const employeeModalTitle = document.getElementById('employee-modal-title');
        const employeeIdInput = document.getElementById('employee-id');
        const employeeNameInput = document.getElementById('employee-name');
        const employeeEmailInput = document.getElementById('employee-email');
        const employeeDepartmentInput = document.getElementById('employee-department');
        const employeesTableBody = document.getElementById('employees-table-body');

        function openEmployeeModal(employee = null) {
            employeeForm.reset(); // Clear form fields
            employeeIdInput.value = ''; // Clear hidden ID

            if (employee) {
                // Edit mode
                employeeModalTitle.textContent = 'Edit Employee';
                employeeIdInput.value = employee.id;
                employeeNameInput.value = employee.name;
                employeeEmailInput.value = employee.email;
                employeeDepartmentInput.value = employee.department;
            } else {
                // Add mode
                employeeModalTitle.textContent = 'Add New Employee';
            }
            employeeModal.classList.remove('hidden');
            employeeModal.style.display = 'flex'; // Ensure flex for centering
        }

        function closeEmployeeModal() {
            employeeModal.classList.add('hidden');
            employeeModal.style.display = 'none';
        }

        employeeForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const id = employeeIdInput.value;
            const name = employeeNameInput.value;
            const email = employeeEmailInput.value;
            const department = employeeDepartmentInput.value;

            if (id) {
                // Update existing employee
                const index = employees.findIndex(emp => emp.id == id);
                if (index !== -1) {
                    employees[index] = { id: parseInt(id), name, email, department };
                    showMessageBox('Employee updated successfully!');
                }
            } else {
                // Add new employee
                const newEmployee = {
                    id: nextEmployeeId++,
                    name,
                    email,
                    department
                };
                employees.push(newEmployee);
                showMessageBox('Employee added successfully!');
            }
            renderEmployees();
            updateDashboardCounts();
            closeEmployeeModal();
        });

        function renderEmployees() {
            employeesTableBody.innerHTML = ''; // Clear existing rows
            employees.forEach(employee => {
                const row = employeesTableBody.insertRow();
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${employee.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${employee.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${employee.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${employee.department}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button onclick="editEmployee(${employee.id})" class="text-indigo-600 hover:text-indigo-900 mr-3">Edit</button>
                        <button onclick="deleteEmployee(${employee.id})" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
            });
        }

        function editEmployee(id) {
            const employee = employees.find(emp => emp.id === id);
            if (employee) {
                openEmployeeModal(employee);
            }
        }

        function deleteEmployee(id) {
            if (confirm('Are you sure you want to delete this employee?')) {
                employees = employees.filter(emp => emp.id !== id);
                renderEmployees();
                updateDashboardCounts();
                showMessageBox('Employee deleted successfully!');
            }
        }

        // --- Leave Management Functions ---
        const leaveModal = document.getElementById('leave-modal');
        const leaveForm = document.getElementById('leave-form');
        const leaveEmployeeIdSelect = document.getElementById('leave-employee-id');
        const leaveTypeInput = document.getElementById('leave-type');
        const leaveStartDateInput = document.getElementById('leave-start-date');
        const leaveEndDateInput = document.getElementById('leave-end-date');
        const leaveTableBody = document.getElementById('leave-table-body');

        function openLeaveModal() {
            leaveForm.reset(); // Clear form fields
            populateEmployeeSelect(); // Populate employee names for leave request
            leaveModal.classList.remove('hidden');
            leaveModal.style.display = 'flex'; // Ensure flex for centering
        }

        function closeLeaveModal() {
            leaveModal.classList.add('hidden');
            leaveModal.style.display = 'none';
        }

        function populateEmployeeSelect() {
            leaveEmployeeIdSelect.innerHTML = '<option value="">Select Employee</option>'; // Clear existing options
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                leaveEmployeeIdSelect.appendChild(option);
            });
        }

        leaveForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const employeeId = parseInt(leaveEmployeeIdSelect.value);
            const employeeName = leaveEmployeeIdSelect.options[leaveEmployeeIdSelect.selectedIndex].textContent;
            const type = leaveTypeInput.value;
            const startDate = leaveStartDateInput.value;
            const endDate = leaveEndDateInput.value;

            if (!employeeId || !type || !startDate || !endDate) {
                showMessageBox('Please fill in all leave request fields.');
                return;
            }

            const newLeave = {
                id: nextLeaveId++,
                employeeId,
                employeeName,
                type,
                startDate,
                endDate,
                status: 'Pending' // Default status
            };
            leaves.push(newLeave);
            renderLeaves();
            updateDashboardCounts();
            closeLeaveModal();
            showMessageBox('Leave request submitted successfully!');
        });

        function renderLeaves() {
            leaveTableBody.innerHTML = ''; // Clear existing rows
            leaves.forEach(leave => {
                const row = leaveTableBody.insertRow();
                let statusClass = '';
                switch (leave.status) {
                    case 'Pending':
                        statusClass = 'bg-yellow-100 text-yellow-800';
                        break;
                    case 'Approved':
                        statusClass = 'bg-green-100 text-green-800';
                        break;
                    case 'Rejected':
                        statusClass = 'bg-red-100 text-red-800';
                        break;
                }

                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${leave.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${leave.employeeName}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${leave.type}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${leave.startDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${leave.endDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                            ${leave.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button onclick="approveLeave(${leave.id})" class="text-green-600 hover:text-green-900 mr-3 ${leave.status !== 'Pending' ? 'opacity-50 cursor-not-allowed' : ''}" ${leave.status !== 'Pending' ? 'disabled' : ''}>Approve</button>
                        <button onclick="rejectLeave(${leave.id})" class="text-red-600 hover:text-red-900 ${leave.status !== 'Pending' ? 'opacity-50 cursor-not-allowed' : ''}" ${leave.status !== 'Pending' ? 'disabled' : ''}>Reject</button>
                    </td>
                `;
            });
        }

        function approveLeave(id) {
            const leaveIndex = leaves.findIndex(l => l.id === id);
            if (leaveIndex !== -1) {
                if (leaves[leaveIndex].status === 'Pending') {
                    leaves[leaveIndex].status = 'Approved';
                    renderLeaves();
                    showMessageBox('Leave request approved!');
                } else {
                    showMessageBox('This leave request is not pending.');
                }
            }
        }

        function rejectLeave(id) {
            const leaveIndex = leaves.findIndex(l => l.id === id);
            if (leaveIndex !== -1) {
                if (leaves[leaveIndex].status === 'Pending') {
                    leaves[leaveIndex].status = 'Rejected';
                    renderLeaves();
                    showMessageBox('Leave request rejected!');
                } else {
                    showMessageBox('This leave request is not pending.');
                }
            }
        }


        // Initial rendering on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Seed some initial data for demonstration
            employees.push({ id: nextEmployeeId++, name: 'Alice Johnson', email: 'alice.j@example.com', department: 'HR' });
            employees.push({ id: nextEmployeeId++, name: 'Bob Williams', email: 'bob.w@example.com', department: 'Engineering' });
            leaves.push({ id: nextLeaveId++, employeeId: 1, employeeName: 'Alice Johnson', type: 'Annual', startDate: '2025-07-15', endDate: '2025-07-20', status: 'Pending' });
            leaves.push({ id: nextLeaveId++, employeeId: 2, employeeName: 'Bob Williams', type: 'Sick', startDate: '2025-07-01', endDate: '2025-07-01', status: 'Approved' });

            showSection('dashboard-section'); // Show dashboard by default
            updateDashboardCounts(); // Update dashboard counts initially
        });

        // Close modals when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target == employeeModal) {
                closeEmployeeModal();
            }
            if (event.target == leaveModal) {
                closeLeaveModal();
            }
        });
    </script>
</body>
</html>
